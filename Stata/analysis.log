------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\kajam\OneDrive\Documents\GitHub\vaccine_equity_kenya\Stata\analysis.log
  log type:  text
 opened on:  31 Jan 2023, 13:59:33

. 
. // set working directory where DHS dataset is located
. cd "C:\Users\kajam\OneDrive\Documents\GitHub\vaccine_equity_kenya\Stata"
C:\Users\kajam\OneDrive\Documents\GitHub\vaccine_equity_kenya\Stata

. 
. // 2014 Kenya DHS dataset
. // download from DHS upon registration
. // https://www.dhsprogram.com/data/dataset/Kenya_Standard-DHS_2014.cfm
. use KEKR72FL.dta, clear

. 
. // Sampling weights
. // https://blog.dhsprogram.com/sampling-weighting-at-dhs/
. // https://dhsprogram.com/Data/Guide-to-DHS-Statistics/Analyzing_DHS_Data.htm
. 
. // 2-stage cluster sampling procedure
. // survey weighting
. // v005 - women's individual sample weight
. // v021 - primary sampling unit
. // v023 - stratification used in sample design
. generate wgt = v005 / 1000000

. svyset [pw = wgt], psu (v021) strata (v023)

Sampling weights: wgt
             VCE: linearized
     Single unit: missing
        Strata 1: v023
 Sampling unit 1: v021
           FPC 1: <zero>

. 
. // Install Stata programs for data analysis
. // collin -- Collinearity diagnostics
. // https://stats.idre.ucla.edu/stata/ado/analysis/
. * findit collin
. * net describe collin, from (https://stats.idre.ucla.edu/stat/stata/ado/analysis)
. * net install collin
. net install collin, from (https://stats.idre.ucla.edu/stat/stata/ado/analysis) replace
checking collin consistency and verifying not already installed...
all files already exist and are up to date.

. 
. // -----------------------------------------------------------------------------
. // Restrict data to living children aged 12-23 months and drop all other observations
. tab b5

   child is |
      alive |      Freq.     Percent        Cum.
------------+-----------------------------------
         no |        871        4.15        4.15
        yes |     20,093       95.85      100.00
------------+-----------------------------------
      Total |     20,964      100.00

. gen childalive = 0

. replace childalive = 1 if inlist(b5, 1)  // child is alive (yes is coded as "1")
(20,093 real changes made)

. keep if childalive == 1
(871 observations deleted)

. *Reduces n from 20,964 to 20,093 (deleted 871)
. 
. gen child=0

. replace child = 1 if inlist(hw1, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23)  // 12-23 months
(3,965 real changes made)

. keep if child==1
(16,128 observations deleted)

. *Reduces n from 20,093 to 3,965 (deleted 16,128)
. // -----------------------------------------------------------------------------
. 
end of do-file

. do "C:\Users\kajam\AppData\Local\Temp\STD32a0_000000.tmp"

. svy: tab b4
(running tabulate on estimation sample)

Number of strata =    92                          Number of obs   =      3,965
Number of PSUs   = 1,391                          Population size = 3,677.5106
                                                  Design df       =      1,299

----------------------
sex of    |
child     | proportion
----------+-----------
     male |      .5205
   female |      .4795
          | 
    Total |          1
----------------------
Key: proportion = Cell proportion

. 
end of do-file

. do "C:\Users\kajam\AppData\Local\Temp\STD32a0_000000.tmp"

. // -----------------------------------------------------------------------------
. // Generate new variables
. 
. // Generate new variable for maternal age (in months)
. gen matage = v008 - v011

. 
. // Generate new variable for maternal age at birth
. gen matagebirth = b3 - v011

. 
. // Generate new variables for each vaccine to categorize as vaccinated, not vaccinated, unknown
. * BCG
. gen bcg=h2
(1 missing value generated)

. recode bcg 0=0 1/3=1 8=8
(880 changes made to bcg)

. label var bcg "BCG"

. label define labbcg 0 "No" 1 "Yes" 8 "Unknown"

. label value bcg labbcg

. tab bcg h2 // to verify coding works

           |                      received bcg
       BCG |        no  vaccinati  reported   vaccinati  don't kno |     Total
-----------+-------------------------------------------------------+----------
        No |       166          0          0          0          0 |       166 
       Yes |         0      2,917        854         26          0 |     3,797 
   Unknown |         0          0          0          0          1 |         1 
-----------+-------------------------------------------------------+----------
     Total |       166      2,917        854         26          1 |     3,964 

. 
end of do-file

. do "C:\Users\kajam\AppData\Local\Temp\STD32a0_000000.tmp"

. * DPT1
. gen dpt1=h3
(1 missing value generated)

. recode dpt1 0=0 1/3=1 8=8
(859 changes made to dpt1)

. label var dpt1 "DPT1"

. label define labdpt1 0 "No" 1 "Yes" 8 "Unknown"

. label value dpt1 labdpt1

. tab dpt1 h3 // to verify coding works

           |                     received dpt 1
      DPT1 |        no  vaccinati  reported   vaccinati  don't kno |     Total
-----------+-------------------------------------------------------+----------
        No |       132          0          0          0          0 |       132 
       Yes |         0      2,968        838         21          0 |     3,827 
   Unknown |         0          0          0          0          5 |         5 
-----------+-------------------------------------------------------+----------
     Total |       132      2,968        838         21          5 |     3,964 

. 
end of do-file

. cd "C:\Users\kajam\Downloads\stata_question"
C:\Users\kajam\Downloads\stata_question

. do "C:\Users\kajam\Downloads\stata_question\babies_code.do"

. // babies code
. 
. // log file
. log using analysis.log, replace
log file already open
r(604);

end of do-file

r(604);

. do "C:\Users\kajam\AppData\Local\Temp\STD32a0_000000.tmp"

. // babies code
. 
. // log file
. log using analysis.log, replace
log file already open
r(604);

end of do-file

r(604);

. do "C:\Users\kajam\AppData\Local\Temp\STD32a0_000000.tmp"

. log close
      name:  <unnamed>
       log:  C:\Users\kajam\OneDrive\Documents\GitHub\vaccine_equity_kenya\Stata\analysis.log
  log type:  text
 closed on:  31 Jan 2023, 23:03:39
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
